# author igautam1711@gmail.com
# to build:
# docker build -t redis .
# to change port or max memory when starting use:
# docker run -e "REDIS_PORT=6379" -e "MAX_MEMORY=2gb" -d redis

#The ubuntu:latest tag points to the "latest LTS", since that's the version recommended for general use. We can specify the exact version in this case as Ubuntu 18.04 

FROM ubuntu:latest

RUN apt update
RUN apt install -y redis-server

CMD sed -i.bak "s:# maxmemory <bytes>:maxmemory $MAX_MEMORY:g" etc/redis/redis.conf && sed -i.bak s/6379/$REDIS_PORT/g etc/redis/redis.conf && sed -i.bak "s:daemonize yes:daemonize no:g" etc/redis/redis.conf && sed -i.bak s/::1//g etc/redis/redis.conf && redis-server /etc/redis/redis.conf
